info:
  query:
    truncate_landing: TRUNCATE TABLE LANDING.SAILTHRU_ALL_SUBSCRIBERS_EXCLUDING_OPT_OUTS;
    Copy_Command: Copy into LANDING.SAILTHRU_ALL_SUBSCRIBERS_EXCLUDING_OPT_OUTS(FILENAME,JSON,PROCESS_DATE,PROCESS_ID) FROM (SELECT METADATA$FILENAME  filename,$1,CURRENT_TIMESTAMP,{PROCESS_ID} from @ga_extract_stg/Sail_Thru/All_Subcribers/All_Subcribers_{filedate}.json t) file_format = (format_name = SAMPLE_JSON);
    Archive: INSERT INTO Archive.SAILTHRU_ALL_SUBSCRIBERS_EXCLUDING_OPT_OUTS(DAY,LIST,ACTIVE_COUNT,COUNT_TIME,DISENGAGED_COUNT,DORMANT_COUNT,EMAIL_COUNT,ENGAGED_COUNT,HARDBOUNCE_COUNT,LISTS_COUNT,LISTS_REMOVE_COUNT,LISTS_SIGNUP_COUNT,NEW_COUNT,OPTOUT_COUNT,OPTOUT_LOSS_COUNT,PASSIVE_COUNT,SIGNUP_MONTH, SOURCE_COUNT,SOURCE_SIGNUP_COUNT,SPAM_COUNT,SPAM_LOSS_COUNT,VALID_COUNT,PROCESS_DATE,PROCESS_ID) SELECT JSON:day DAY,REPLACE(JSON:list,'"','') LIST,JSON:active_count ACTIVE_COUNT,REPLACE(JSON:count_time,'"','') COUNT_TIME,JSON:disengaged_count DISENGAGAED_COUNT,JSON:dormant_count DORMANT_COUNT,JSON:email_count EMAIL_COUNT,JSON:engaged_count ENGAGED_COUNT,JSON:hardbounce_count HARDBOUNCE_COUNT,JSON:lists_count LISTS_COUNT,JSON:lists_remove_count LISTS_REMOVE_COUNT,JSON:lists_signup_count LISTS_SIGNUP_COUNT,JSON:new_count NEW_COUNT,JSON:optout_count OPTOUT_COUNT,JSON:optout_loss_count OPTOUT_LOSS_COUNT,JSON:passive_count PASSIVE_COUNT,JSON:signup_month SIGNUP_MONTH,JSON:source_count SOURCE_COUNT,JSON:source_signup_count SOURCE_SIGNUP_COUNT,JSON:spam_count SPAM_COUNT,JSON:spam_loss_count SPAM_LOSS_COUNT,JSON:valid_count VALID_COUNT,CURRENT_TIMESTAMP,PROCESS_ID FROM LANDING.SAILTHRU_ALL_SUBSCRIBERS_EXCLUDING_OPT_OUTS WHERE PROCESS_ID=(SELECT MAX(PROCESS_ID) FROM LANDING.SAILTHRU_ALL_SUBSCRIBERS_EXCLUDING_OPT_OUTS);
    Integration: INSERT INTO DWPD_SAILTHRU.SAILTHRU_ALL_SUBSCRIBERS_EXCLUDING_OPT_OUTS(DAY,LIST,ACTIVE_COUNT,COUNT_TIME,DISENGAGED_COUNT,DORMANT_COUNT,EMAIL_COUNT,ENGAGED_COUNT,HARDBOUNCE_COUNT,LISTS_COUNT,LISTS_REMOVE_COUNT,LISTS_SIGNUP_COUNT,NEW_COUNT,OPTOUT_COUNT,OPTOUT_LOSS_COUNT,PASSIVE_COUNT,SIGNUP_MONTH,SOURCE_COUNT,SOURCE_SIGNUP_COUNT,SPAM_COUNT,SPAM_LOSS_COUNT,VALID_COUNT,INSERT_DATE,PROCESS_ID) SELECT DAY,LIST,ACTIVE_COUNT,COUNT_TIME,DISENGAGED_COUNT,DORMANT_COUNT,EMAIL_COUNT,ENGAGED_COUNT,HARDBOUNCE_COUNT,LISTS_COUNT,LISTS_REMOVE_COUNT,LISTS_SIGNUP_COUNT,NEW_COUNT,OPTOUT_COUNT,OPTOUT_LOSS_COUNT,PASSIVE_COUNT,SIGNUP_MONTH,SOURCE_COUNT,SOURCE_SIGNUP_COUNT,SPAM_COUNT,SPAM_LOSS_COUNT,VALID_COUNT,CURRENT_TIMESTAMP,PROCESS_ID FROM Archive.SAILTHRU_ALL_SUBSCRIBERS_EXCLUDING_OPT_OUTS WHERE PROCESS_ID=(SELECT MAX(PROCESS_ID) FROM Archive.SAILTHRU_ALL_SUBSCRIBERS_EXCLUDING_OPT_OUTS);
    